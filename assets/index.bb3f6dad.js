var e=Object.defineProperty,a=Object.prototype.hasOwnProperty,l=Object.getOwnPropertySymbols,t=Object.prototype.propertyIsEnumerable,n=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,i=(e,i)=>{for(var s in i||(i={}))a.call(i,s)&&n(e,s,i[s]);if(l)for(var s of l(i))t.call(i,s)&&n(e,s,i[s]);return e};import{r as s,l as r,a as o,c,w as p,o as u,b as d,d as g,e as m,v as f,f as b,F as v,g as y,t as h,h as k,i as E,j as T,k as w,m as C,n as R,p as O}from"./vendor.b3566522.js";!function(e=".",a="__import__"){try{self[a]=new Function("u","return import(u)")}catch(l){const t=new URL(e,location),n=e=>{URL.revokeObjectURL(e.src),e.remove()};self[a]=e=>new Promise(((l,i)=>{const s=new URL(e,t);if(self[a].moduleMap[s])return l(self[a].moduleMap[s]);const r=new Blob([`import * as m from '${s}';`,`${a}.moduleMap['${s}']=m;`],{type:"text/javascript"}),o=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(r),onerror(){i(new Error(`Failed to import: ${e}`)),n(o)},onload(){l(self[a].moduleMap[s]),n(o)}});document.head.appendChild(o)})),self[a].moduleMap={}}}("assets/");const M={id:"36ec601ba440417ead12dc49d612665d"},S=s(null);function j(e){return new Date(e).toLocaleString()}const D=o({loading:!1,error:"",data:[]}),P=s(null),_=c((()=>D.data.find((e=>{var a;return(null==(a=e.attributes)?void 0:a.objectid)==P.value}))));function U(e){P.value=e}const L=o({page:1,limit:10}),x=s(0),F=c((()=>L.limit*(L.page-1))),N=c((()=>Math.ceil(x.value/L.limit))),A=o({upcoming:!1,search:""});p([L,A],((e,a=500)=>{let l=null;return(...t)=>{window.clearTimeout(l),l=window.setTimeout((()=>{e.apply(null,t)}),a)}})((()=>{if(L.page>N.value)return L.page=1;G()})));const $=c((()=>["DATE_OPENED >= CURRENT_TIMESTAMP+1",A.search?`STREET like '%${A.search}%'`:null,A.upcoming?"DATE_CLOSED > CURRENT_TIMESTAMP":"(DATE_CLOSED <= CURRENT_TIMESTAMP)"].filter(Boolean).join(" AND "))),I=c((()=>({where:$.value,f:"json",outFields:"*",orderByFields:["DATE_CLOSED asc","DATE_OPENED asc","STREET asc"],returnGeometry:!0,num:L.limit,start:F.value})));async function G(){D.error="",D.loading=!0;try{const e=await async function(){const[e]=await r(["esri/layers/FeatureLayer"]);return new e(S.value)}();x.value=await e.queryFeatureCount({where:$.value});const{features:a}=await e.queryFeatures(I.value);D.data=a.map((a=>i(i({},a.toJSON()),{popupTemplate:e.popupInfo})))}catch(e){D.error=e.message}finally{D.loading=!1}}const V={setup:()=>({filters:A})},B={class:"d-flex justify-content-between align-items-center flex-wrap"},J={class:"flex-grow-1"},q={class:"p-2"},W={class:"form-check form-check-inline"},Y=g("label",{class:"form-check-label",for:"inlineRadio1"}," Current Closures ",-1),z={class:"form-check form-check-inline"},H=g("label",{class:"form-check-label",for:"inlineRadio2"}," Upcoming Closures ",-1);V.render=function(e,a,l,t,n,i){return u(),d("div",B,[g("div",J,[m(g("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>t.filters.search=e),type:"text",class:"form-control",placeholder:"Filter by street name"},null,512),[[f,t.filters.search]])]),g("div",q,[g("div",W,[m(g("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>t.filters.upcoming=e),class:"form-check-input",type:"radio",name:"currentOrUpcomingRadioGroup",id:"inlineRadio1",value:!1},null,512),[[b,t.filters.upcoming]]),Y]),g("div",z,[m(g("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>t.filters.upcoming=e),class:"form-check-input",type:"radio",name:"currentOrUpcomingRadioGroup",id:"inlineRadio2",value:!0},null,512),[[b,t.filters.upcoming]]),H])])])};const K={setup:()=>({closures:D,activateClosure:U,formatDate:j})},Q={key:0,class:"table-responsive"},X={class:"table table-striped table-sm small"},Z=g("thead",null,[g("tr",null,[g("th",null,"Street"),g("th",null,"Type"),g("th",null,"Closed"),g("th",null,"Opened")])],-1),ee=g("br",null,null,-1),ae=k(" from "),le=k(" to "),te={key:1,class:"text-center py-5"},ne=g("p",{class:"h4"},"No Closures",-1),ie=g("p",null,"Try refining your search.",-1);K.render=function(e,a,l,t,n,i){return t.closures.data.length?(u(),d("div",Q,[g("table",X,[Z,g("tbody",null,[(u(!0),d(v,null,y(t.closures.data,(({attributes:e})=>(u(),d("tr",{key:e.objectid,id:`closure-${e.objectid}`},[g("td",null,[g("strong",null,[g("a",{href:"#","data-bs-toggle":"modal","data-bs-target":"#popupModal",onClick:a=>t.activateClosure(e.objectid)},h(e.STREET),9,["onClick"])]),ee,g("small",null,[ae,g("strong",null,h(e.FROM_STREET),1),le,g("strong",null,h(e.TO_STREET),1)])]),g("td",null,h(e.CLOSURE_TYPE.split("_").join(" ")),1),g("td",null,h(t.formatDate(e.DATE_CLOSED)),1),g("td",null,h(t.formatDate(e.DATE_OPENED)),1)],8,["id"])))),128))])])])):(u(),d("div",te,[ne,ie]))};const se={setup:()=>({pagination:L,pages:N})},re={key:0},oe={class:"row align-items-center"},ce={class:"col-sm-9"},pe={"aria-label":"Page navigation"},ue={class:"m-0 pagination justify-content-center"},de=g("span",{"aria-hidden":"true"},"«",-1),ge={key:0,class:"page-item disabled"},me=g("span",{class:"page-link"},"...",-1),fe={key:1,class:"page-item disabled"},be=g("span",{class:"page-link"},"...",-1),ve=g("span",{"aria-hidden":"true"},"»",-1),ye={class:"col-sm-3"};se.render=function(e,a,l,t,n,i){return t.pages>1?(u(),d("div",re,[g("div",oe,[g("div",ce,[g("nav",pe,[g("ul",ue,[g("li",{class:["page-item",1==t.pagination.page?"disabled":null]},[g("a",{class:"page-link",href:"#",tabindex:"-1","aria-disabled":1==t.pagination.page,onClick:a[1]||(a[1]=E((e=>t.pagination.page--),["prevent"])),"aria-label":"Previous"},[de],8,["aria-disabled"])],2),g("li",{class:["page-item",1==t.pagination.page?"active":null],"aria-current":1==t.pagination.page&&"page"},[g("a",{class:"page-link",href:"#",onClick:a[2]||(a[2]=E((e=>t.pagination.page=1),["prevent"]))}," 1 ")],10,["aria-current"]),t.pagination.page>3?(u(),d("li",ge,[me])):T("",!0),(u(!0),d(v,null,y(t.pages,(e=>(u(),d(v,{key:e},[1!=e&&e!=t.pages&&Math.abs(t.pagination.page-e)<3?(u(),d("li",{key:0,class:["page-item",t.pagination.page==e?"active":null],"aria-current":t.pagination.page==e&&"page"},[g("a",{class:"page-link",href:"#",onClick:E((a=>t.pagination.page=e),["prevent"])},h(e),9,["onClick"])],10,["aria-current"])):T("",!0)],64)))),128)),t.pagination.page<t.pages-3?(u(),d("li",fe,[be])):T("",!0),g("li",{class:["page-item",t.pagination.page==t.pages?"active":null],"aria-current":t.pagination.page==t.pages&&"page"},[g("a",{class:"page-link",href:"#",onClick:a[3]||(a[3]=E((e=>t.pagination.page=t.pages),["prevent"]))},h(t.pages),1)],10,["aria-current"]),g("li",{class:["page-item",t.pagination.page==t.pages?"disabled":null]},[g("a",{class:"page-link",href:"#","aria-disabled":t.pagination.page==t.pages,onClick:a[4]||(a[4]=E((e=>t.pagination.page++),["prevent"])),"aria-label":"Next"},[ve],8,["aria-disabled"])],2)])])]),g("div",ye,[m(g("select",{"onUpdate:modelValue":a[5]||(a[5]=e=>t.pagination.limit=e),class:"form-select form-control","aria-label":"Results per page"},[(u(),d(v,null,y([10,25,50],(e=>g("option",{key:e,value:e},h(`${e} results per page`),9,["value"]))),64))],512),[[w,t.pagination.limit]])])])])):T("",!0)};const he={},ke={class:"ratio ratio-16x9"},Ee=g("iframe",{src:"./map.html",frameborder:"0"},null,-1);he.render=function(e,a){return u(),d("div",ke,[Ee])};let Te={};const we=s(null);s(null),p(_,(async function(e){Te.visible=!1;const[a,l]=await r(["esri/Graphic","esri/widgets/Popup"]),t=a.fromJSON(e);Te=new l({container:we.value,features:[t]}),Te.visible=!0}));const Ce={setup:()=>({popupRef:we,activeClosure:_})},Re={class:"modal fade",id:"popupModal",tabindex:"-1","aria-labelledby":"popupModalLabel","aria-hidden":"true"},Oe={class:"modal-dialog modal-xl"},Me={class:"modal-content"},Se={class:"modal-header"},je={class:"modal-title",id:"popupModalLabel"},De=g("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Pe={ref:"popupRef",class:"modal-body"},_e=g("div",{class:"modal-footer"},[g("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1);Ce.render=function(e,a,l,t,n,i){var s,r;return u(),d("div",Re,[g("div",Oe,[g("div",Me,[g("div",Se,[g("h5",je,h(null==(r=null==(s=t.activeClosure)?void 0:s.attributes)?void 0:r.STREET),1),De]),g("div",Pe,null,512),_e])])])};const Ue={setup:()=>(C((async()=>{await async function(){const[e]=await r(["esri/WebMap"]),a=new e({portalItem:M});await a.load(),S.value=a.layers.items[0].toJSON()}(),await G()})),{closures:D}),components:{Filters:V,ClosuresTable:K,Pagination:se,ClosuresMap:he,ModalPopup:Ce}},Le={key:0,class:"py-5"},xe={class:"alert alert-warning",role:"alert"},Fe={key:1},Ne={key:0,class:"p-5 text-center"},Ae=g("div",{class:"spinner-border text-dark",role:"status"},[g("span",{class:"visually-hidden"},"Loading...")],-1);Ue.render=function(e,a,l,t,n,i){const s=R("ClosuresMap"),r=R("Filters"),o=R("ClosuresTable"),c=R("Pagination"),p=R("ModalPopup");return u(),d(v,null,[g(s),t.closures.error?(u(),d("div",Le,[g("div",xe,h(t.closures.error),1)])):(u(),d("div",Fe,[g(r,{class:"my-3"}),t.closures.loading?(u(),d("div",Ne,[Ae])):(u(),d(o,{key:1})),g(c),g(p)]))],64)},O(Ue).mount("#app");
