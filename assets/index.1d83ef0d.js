var e=Object.defineProperty,a=Object.prototype.hasOwnProperty,l=Object.getOwnPropertySymbols,t=Object.prototype.propertyIsEnumerable,n=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,i=(e,i)=>{for(var s in i||(i={}))a.call(i,s)&&n(e,s,i[s]);if(l)for(var s of l(i))t.call(i,s)&&n(e,s,i[s]);return e};import{r as s,l as o,a as r,c,w as p,o as u,b as d,d as g,e as m,v as f,f as b,F as v,g as y,t as w,h,i as E,j as k,k as T,m as C,n as R,p as O}from"./vendor.b3566522.js";!function(e=".",a="__import__"){try{self[a]=new Function("u","return import(u)")}catch(l){const t=new URL(e,location),n=e=>{URL.revokeObjectURL(e.src),e.remove()};self[a]=e=>new Promise(((l,i)=>{const s=new URL(e,t);if(self[a].moduleMap[s])return l(self[a].moduleMap[s]);const o=new Blob([`import * as m from '${s}';`,`${a}.moduleMap['${s}']=m;`],{type:"text/javascript"}),r=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(o),onerror(){i(new Error(`Failed to import: ${e}`)),n(r)},onload(){l(self[a].moduleMap[s]),n(r)}});document.head.appendChild(r)})),self[a].moduleMap={}}}("assets/");const M={id:"36ec601ba440417ead12dc49d612665d"};async function S(){const[e]=await o(["esri/WebMap"]);return new e({portalItem:M})}const j=s(null);function D(e){return new Date(e).toLocaleString()}const L=r({loading:!1,error:"",data:[]}),P=s(null),_=c((()=>L.data.find((e=>{var a;return(null==(a=e.attributes)?void 0:a.objectid)==P.value}))));function x(e){P.value=e}const U=r({page:1,limit:10}),N=s(0),A=c((()=>U.limit*(U.page-1))),F=c((()=>Math.ceil(N.value/U.limit))),I=r({upcoming:!1,search:""});p([U,I],((e,a=500)=>{let l=null;return(...t)=>{window.clearTimeout(l),l=window.setTimeout((()=>{e.apply(null,t)}),a)}})((()=>{if(U.page>F.value)return U.page=1;V()})));const $=c((()=>["DATE_OPENED >= CURRENT_TIMESTAMP+1",I.search?`STREET like '%${I.search}%'`:null,I.upcoming?"DATE_CLOSED > CURRENT_TIMESTAMP":"(DATE_CLOSED <= CURRENT_TIMESTAMP)"].filter(Boolean).join(" AND "))),G=c((()=>({where:$.value,f:"json",outFields:"*",orderByFields:["DATE_CLOSED "+(I.upcoming?"asc":"desc"),"DATE_OPENED asc","STREET asc"],returnGeometry:!0,num:U.limit,start:A.value})));async function V(){L.error="",L.loading=!0;try{const e=await async function(){const[e]=await o(["esri/layers/FeatureLayer"]);return new e(j.value)}();N.value=await e.queryFeatureCount({where:$.value});const{features:a}=await e.queryFeatures(G.value);L.data=a.map((a=>i(i({},a.toJSON()),{popupTemplate:e.popupInfo})))}catch(e){L.error=e.message}finally{L.loading=!1}}const J={setup:()=>({filters:I})},B={class:"d-flex justify-content-between align-items-center flex-wrap"},q={class:"flex-grow-1"},H={class:"p-2"},W={class:"form-check form-check-inline"},Y=g("label",{class:"form-check-label",for:"inlineRadio1"}," Current Closures ",-1),z={class:"form-check form-check-inline"},K=g("label",{class:"form-check-label",for:"inlineRadio2"}," Upcoming Closures ",-1);J.render=function(e,a,l,t,n,i){return u(),d("div",B,[g("div",q,[m(g("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>t.filters.search=e),type:"text",class:"form-control",placeholder:"Filter by street name"},null,512),[[f,t.filters.search]])]),g("div",H,[g("div",W,[m(g("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>t.filters.upcoming=e),class:"form-check-input",type:"radio",name:"currentOrUpcomingRadioGroup",id:"inlineRadio1",value:!1},null,512),[[b,t.filters.upcoming]]),Y]),g("div",z,[m(g("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>t.filters.upcoming=e),class:"form-check-input",type:"radio",name:"currentOrUpcomingRadioGroup",id:"inlineRadio2",value:!0},null,512),[[b,t.filters.upcoming]]),K])])])};const Q={setup:()=>({closures:L,activateClosure:x,formatDate:D})},X={key:0,class:"table-responsive"},Z={class:"table table-striped table-sm small"},ee=g("thead",null,[g("tr",null,[g("th",null,"Street"),g("th",null,"Type"),g("th",null,"Closed"),g("th",null,"Opened")])],-1),ae=g("br",null,null,-1),le=h(" from "),te=h(" to "),ne={key:1,class:"text-center py-5"},ie=g("p",{class:"h4"},"No Closures",-1),se=g("p",null,"Try refining your search.",-1);Q.render=function(e,a,l,t,n,i){return t.closures.data.length?(u(),d("div",X,[g("table",Z,[ee,g("tbody",null,[(u(!0),d(v,null,y(t.closures.data,(({attributes:e})=>(u(),d("tr",{key:e.objectid,id:`closure-${e.objectid}`},[g("td",null,[g("strong",null,[g("a",{href:"#","data-bs-toggle":"modal","data-bs-target":"#popupModal",onClick:a=>t.activateClosure(e.objectid)},w(e.STREET),9,["onClick"])]),ae,g("small",null,[le,g("strong",null,w(e.FROM_STREET),1),te,g("strong",null,w(e.TO_STREET),1)])]),g("td",null,w(e.CLOSURE_TYPE.split("_").join(" ")),1),g("td",null,w(t.formatDate(e.DATE_CLOSED)),1),g("td",null,w(t.formatDate(e.DATE_OPENED)),1)],8,["id"])))),128))])])])):(u(),d("div",ne,[ie,se]))};const oe={setup:()=>({pagination:U,pages:F})},re={key:0},ce={class:"row align-items-center"},pe={class:"col-sm-9"},ue={"aria-label":"Page navigation"},de={class:"m-0 pagination justify-content-center"},ge=g("span",{"aria-hidden":"true"},"«",-1),me={key:0,class:"page-item disabled"},fe=g("span",{class:"page-link"},"...",-1),be={key:1,class:"page-item disabled"},ve=g("span",{class:"page-link"},"...",-1),ye=g("span",{"aria-hidden":"true"},"»",-1),we={class:"col-sm-3"};oe.render=function(e,a,l,t,n,i){return t.pages>1?(u(),d("div",re,[g("div",ce,[g("div",pe,[g("nav",ue,[g("ul",de,[g("li",{class:["page-item",1==t.pagination.page?"disabled":null]},[g("a",{class:"page-link",href:"#",tabindex:"-1","aria-disabled":1==t.pagination.page,onClick:a[1]||(a[1]=E((e=>t.pagination.page--),["prevent"])),"aria-label":"Previous"},[ge],8,["aria-disabled"])],2),g("li",{class:["page-item",1==t.pagination.page?"active":null],"aria-current":1==t.pagination.page&&"page"},[g("a",{class:"page-link",href:"#",onClick:a[2]||(a[2]=E((e=>t.pagination.page=1),["prevent"]))}," 1 ")],10,["aria-current"]),t.pagination.page>3?(u(),d("li",me,[fe])):k("",!0),(u(!0),d(v,null,y(t.pages,(e=>(u(),d(v,{key:e},[1!=e&&e!=t.pages&&Math.abs(t.pagination.page-e)<3?(u(),d("li",{key:0,class:["page-item",t.pagination.page==e?"active":null],"aria-current":t.pagination.page==e&&"page"},[g("a",{class:"page-link",href:"#",onClick:E((a=>t.pagination.page=e),["prevent"])},w(e),9,["onClick"])],10,["aria-current"])):k("",!0)],64)))),128)),t.pagination.page<t.pages-3?(u(),d("li",be,[ve])):k("",!0),g("li",{class:["page-item",t.pagination.page==t.pages?"active":null],"aria-current":t.pagination.page==t.pages&&"page"},[g("a",{class:"page-link",href:"#",onClick:a[3]||(a[3]=E((e=>t.pagination.page=t.pages),["prevent"]))},w(t.pages),1)],10,["aria-current"]),g("li",{class:["page-item",t.pagination.page==t.pages?"disabled":null]},[g("a",{class:"page-link",href:"#","aria-disabled":t.pagination.page==t.pages,onClick:a[4]||(a[4]=E((e=>t.pagination.page++),["prevent"])),"aria-label":"Next"},[ye],8,["aria-disabled"])],2)])])]),g("div",we,[m(g("select",{"onUpdate:modelValue":a[5]||(a[5]=e=>t.pagination.limit=e),class:"form-select form-control","aria-label":"Results per page"},[(u(),d(v,null,y([10,25,50],(e=>g("option",{key:e,value:e},w(`${e} results per page`),9,["value"]))),64))],512),[[T,t.pagination.limit]])])])])):k("",!0)};const he=s(null);const Ee={setup:()=>(C((async()=>{const[e,a,l,t,n]=await o(["esri/views/MapView","esri/widgets/Home","esri/widgets/Legend","esri/Graphic","esri/widgets/Expand"]),i=await S();let s=new e({map:i,container:he.value});await s.when(),function(e){e.popup.dockEnabled=!0,e.popup.dockOptions.buttonEnabled=!1,e.popup.collapsed=!1,e.popup.dockOptions.collapseEnabled=!1}(s);const r=i.layers.getItemAt(0);p(_,(e=>{if(!e)return;const a=t.fromJSON(e);s.goTo(a)}));const c=new a({view:s});s.ui.add(c,"top-left");const u=new l({view:s,layerInfos:[{layer:r,title:"Legend"}],container:document.createElement("div")}),d=new n({expandIconClass:"esri-icon-layer-list",expandTooltip:"Expand Legend",view:s,content:u.domNode});s.ui.add(u,"bottom-left"),s.ui.add(d,"top-left")})),{mapRef:he})},ke={class:"ratio ratio-16x9"},Te={id:"map",ref:"mapRef",class:"embed-responsive-item"};Ee.render=function(e,a,l,t,n,i){return u(),d("div",ke,[g("div",Te,null,512)])};let Ce={};const Re=s(null);s(null),p(_,(async function(e){Ce.visible=!1;const[a,l]=await o(["esri/Graphic","esri/widgets/Popup"]),t=a.fromJSON(e);Ce=new l({container:Re.value,features:[t]}),Ce.visible=!0}));const Oe={setup:()=>({popupRef:Re,activeClosure:_})},Me={class:"modal fade",id:"popupModal",tabindex:"-1","aria-labelledby":"popupModalLabel","aria-hidden":"true"},Se={class:"modal-dialog modal-xl"},je={class:"modal-content"},De={class:"modal-header"},Le={class:"modal-title",id:"popupModalLabel"},Pe=g("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),_e={ref:"popupRef",class:"modal-body p-1"},xe=g("div",{class:"modal-footer"},[g("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1);Oe.render=function(e,a,l,t,n,i){var s,o;return u(),d("div",Me,[g("div",Se,[g("div",je,[g("div",De,[g("h5",Le,w(null==(o=null==(s=t.activeClosure)?void 0:s.attributes)?void 0:o.STREET),1),Pe]),g("div",_e,null,512),xe])])])};const Ue={setup:()=>(C((async()=>{await async function(){const e=await S();await e.load(),j.value=e.layers.items[0].toJSON()}(),await V()})),{closures:L}),components:{Filters:J,ClosuresTable:Q,Pagination:oe,ClosuresMap:Ee,ModalPopup:Oe}},Ne={key:0,class:"py-5"},Ae={class:"alert alert-warning",role:"alert"},Fe={key:1},Ie={key:0,class:"p-5 text-center"},$e=g("div",{class:"spinner-border text-dark",role:"status"},[g("span",{class:"visually-hidden"},"Loading...")],-1);Ue.render=function(e,a,l,t,n,i){const s=R("ClosuresMap"),o=R("Filters"),r=R("ClosuresTable"),c=R("Pagination"),p=R("ModalPopup");return u(),d(v,null,[g(s),t.closures.error?(u(),d("div",Ne,[g("div",Ae,w(t.closures.error),1)])):(u(),d("div",Fe,[g(o,{class:"my-3"}),t.closures.loading?(u(),d("div",Ie,[$e])):(u(),d(r,{key:1})),g(c),g(p)]))],64)},O(Ue).mount("#app");
